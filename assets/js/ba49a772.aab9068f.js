"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[2318],{1446:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>r,contentTitle:()=>d,default:()=>h,frontMatter:()=>o,metadata:()=>i,toc:()=>a});const i=JSON.parse('{"id":"remaining-channels-integration-guide","title":"REMAINING CHANNELS INTEGRATION","description":"Overview","source":"@site/docs/remaining-channels-integration-guide.md","sourceDirName":".","slug":"/remaining-channels-integration-guide","permalink":"/backend-docs/docs/remaining-channels-integration-guide","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/remaining-channels-integration-guide.md","tags":[],"version":"current","sidebarPosition":14,"frontMatter":{"sidebar_position":14},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udd10 Two-Factor Authentication (2FA) \u2013 Frontend Integration Guide","permalink":"/backend-docs/docs/2fa-auth-integration"}}');var s=t(4848),c=t(8453);const o={sidebar_position:14},d="REMAINING CHANNELS INTEGRATION",r={},a=[{value:"Overview",id:"overview",level:2},{value:"OAuth Flow",id:"oauth-flow",level:2},{value:"1. Initiate Authentication",id:"1-initiate-authentication",level:3},{value:"2. Handle OAuth Callback",id:"2-handle-oauth-callback",level:3},{value:"3. Complete Connection",id:"3-complete-connection",level:3},{value:"Disconnect Flow",id:"disconnect-flow",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Key Implementation Details",id:"key-implementation-details",level:2},{value:"Overview",id:"overview-1",level:2},{value:"OAuth Flow",id:"oauth-flow-1",level:2},{value:"1. Initiate Authentication",id:"1-initiate-authentication-1",level:3},{value:"2. Handle OAuth Callback",id:"2-handle-oauth-callback-1",level:3},{value:"3. Complete Connection",id:"3-complete-connection-1",level:3},{value:"Disconnect Flow",id:"disconnect-flow-1",level:2},{value:"API Endpoints",id:"api-endpoints-1",level:2},{value:"Key Implementation Details",id:"key-implementation-details-1",level:2},{value:"Overview",id:"overview-2",level:2},{value:"OAuth Flow",id:"oauth-flow-2",level:2},{value:"1. Collect Shop Domain",id:"1-collect-shop-domain",level:3},{value:"2. Handle OAuth Callback",id:"2-handle-oauth-callback-2",level:3},{value:"3. Complete Connection",id:"3-complete-connection-2",level:3},{value:"Disconnect Flow",id:"disconnect-flow-2",level:2},{value:"API Endpoints",id:"api-endpoints-2",level:2},{value:"Key Implementation Details",id:"key-implementation-details-2",level:2},{value:"Overview",id:"overview-3",level:2},{value:"OAuth Flow",id:"oauth-flow-3",level:2},{value:"1. Initiate Authentication",id:"1-initiate-authentication-2",level:3},{value:"2. Handle OAuth Callback",id:"2-handle-oauth-callback-3",level:3},{value:"3. Complete Connection",id:"3-complete-connection-3",level:3},{value:"Disconnect Flow",id:"disconnect-flow-3",level:2},{value:"API Endpoints",id:"api-endpoints-3",level:2},{value:"Key Implementation Details",id:"key-implementation-details-3",level:2},{value:"Overview",id:"overview-4",level:2},{value:"OAuth Flow",id:"oauth-flow-4",level:2},{value:"1. Initiate Authentication",id:"1-initiate-authentication-3",level:3},{value:"2. Handle OAuth Callback",id:"2-handle-oauth-callback-4",level:3},{value:"3. Complete Connection",id:"3-complete-connection-4",level:3},{value:"Disconnect Flow",id:"disconnect-flow-4",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"Key Implementation Notes",id:"key-implementation-notes",level:2},{value:"API Endpoints",id:"api-endpoints-4",level:2},{value:"Overview",id:"overview-5",level:2},{value:"Phone Authentication Flow",id:"phone-authentication-flow",level:2},{value:"Step 1: Send Code",id:"step-1-send-code",level:3},{value:"Step 2: Verify Code",id:"step-2-verify-code",level:3},{value:"Step 3: Verify 2FA (if needed)",id:"step-3-verify-2fa-if-needed",level:3},{value:"QR Code Authentication Flow",id:"qr-code-authentication-flow",level:2},{value:"Generate QR Code",id:"generate-qr-code",level:3},{value:"Poll for Scan",id:"poll-for-scan",level:3},{value:"Disconnect Flow",id:"disconnect-flow-5",level:2},{value:"API Endpoints",id:"api-endpoints-5",level:2},{value:"Key Implementation Details",id:"key-implementation-details-4",level:2}];function l(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,c.R)(),...e.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(n.header,{children:(0,s.jsx)(n.h1,{id:"remaining-channels-integration",children:"REMAINING CHANNELS INTEGRATION"})}),"\n",(0,s.jsx)(n.h1,{id:"calendly-oauth-integration---frontend-documentation",children:"Calendly OAuth Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Calendly integration uses OAuth 2.0 authorization code flow to connect user accounts. The frontend handles OAuth redirect and exchanges the authorization code with the backend."}),"\n",(0,s.jsx)(n.h2,{id:"oauth-flow",children:"OAuth Flow"}),"\n",(0,s.jsx)(n.h3,{id:"1-initiate-authentication",children:"1. Initiate Authentication"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleCalendlyAuth = () => {\n  setStatus("Redirecting to Calendly...");\n  window.location.href = `${API_BASE}/auth`;\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Redirects to ",(0,s.jsx)(n.code,{children:"GET /api/v1/channels/calendly/auth"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend generates OAuth URL and redirects to Calendly"}),"\n",(0,s.jsx)(n.li,{children:"User authorizes on Calendly's consent screen"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-handle-oauth-callback",children:"2. Handle OAuth Callback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get("code");\n\n  if (code) {\n    connectCalendly(code);\n    window.history.replaceState({}, document.title, window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Calendly redirects back with authorization code in URL"}),"\n",(0,s.jsxs)(n.li,{children:["Frontend extracts ",(0,s.jsx)(n.code,{children:"code"})," query parameter"]}),"\n",(0,s.jsx)(n.li,{children:"Automatically triggers connection"}),"\n",(0,s.jsx)(n.li,{children:"Cleans code from browser history"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-complete-connection",children:"3. Complete Connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const connectCalendly = async (authCode: string) => {\n  setLoading(true);\n  setStatus("Connecting Calendly...");\n\n  const res = await fetch(`${API_BASE}/connect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ authCode }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus(`\u2705 Calendly connected (${data.email})`);\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sends authorization code to backend"}),"\n",(0,s.jsx)(n.li,{children:"Backend exchanges code for access/refresh tokens"}),"\n",(0,s.jsx)(n.li,{children:"Stores encrypted credentials in database"}),"\n",(0,s.jsx)(n.li,{children:"Returns connected account details including email"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (accountId: number) => {\n  if (!confirm("Disconnect this Calendly account?")) return;\n\n  setLoading(true);\n\n  const res = await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ accountId }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus("\u2705 Calendly disconnected");\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:"Revokes tokens and removes the account connection from the database."}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Auth Required"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/calendly/auth"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Initiate OAuth flow"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/calendly/connect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Exchange authorization code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/calendly/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-details",children:"Key Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication"}),": All endpoints require session authentication via cookies (",(0,s.jsx)(n.code,{children:'credentials: "include"'}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Query Parameter"}),": Uses standard ",(0,s.jsx)(n.code,{children:"code"})," parameter for OAuth callback"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"URL Cleanup"}),": Uses ",(0,s.jsx)(n.code,{children:"replaceState"})," to remove OAuth parameters after processing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Handling"}),": Backend returns error messages in response body"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"paypal-oauth-integration---frontend-documentation",children:"PayPal OAuth Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview-1",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"PayPal OAuth uses state parameter encoding for session management. The backend handles the callback and redirects to frontend with success/error indicators."}),"\n",(0,s.jsx)(n.h2,{id:"oauth-flow-1",children:"OAuth Flow"}),"\n",(0,s.jsx)(n.h3,{id:"1-initiate-authentication-1",children:"1. Initiate Authentication"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handlePayPalAuth = () => {\n  setStatus("Redirecting to PayPal...");\n  window.location.href = `${API_BASE}/auth`;\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Redirects to ",(0,s.jsx)(n.code,{children:"GET /api/v1/channels/paypal/auth"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend extracts session from cookie/header"}),"\n",(0,s.jsx)(n.li,{children:"Generates OAuth URL with encoded state containing session ID"}),"\n",(0,s.jsx)(n.li,{children:"Redirects to PayPal authorization"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-handle-oauth-callback-1",children:"2. Handle OAuth Callback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get("code");\n  const state = params.get("state");\n\n  if (code && state) {\n    connectPayPal(code, state);\n    window.history.replaceState({}, document.title, window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Backend Callback Flow:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["PayPal redirects to: ",(0,s.jsx)(n.code,{children:"/api/v1/channels/paypal/connect?code={code}&state={state}"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend decodes state to extract session ID"}),"\n",(0,s.jsx)(n.li,{children:"Validates session and exchanges code for token"}),"\n",(0,s.jsxs)(n.li,{children:["Redirects to frontend: ",(0,s.jsx)(n.code,{children:"/integrations?paypal=success"})," or ",(0,s.jsx)(n.code,{children:"/integrations?paypal=error"})]}),"\n"]}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Frontend can also handle direct parameters:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["If ",(0,s.jsx)(n.code,{children:"code"})," and ",(0,s.jsx)(n.code,{children:"state"})," are present, calls connect endpoint directly"]}),"\n",(0,s.jsxs)(n.li,{children:["Otherwise checks for ",(0,s.jsx)(n.code,{children:"paypal=success"})," or ",(0,s.jsx)(n.code,{children:"paypal=error"})," indicators"]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-complete-connection-1",children:"3. Complete Connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const connectPayPal = async (code: string, state: string) => {\n  setLoading(true);\n  setStatus("Connecting PayPal...");\n\n  const res = await fetch(`${API_BASE}/connect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ authCode: code, state }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus(`\u2705 PayPal connected (${data.email})`);\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sends authorization code and state"}),"\n",(0,s.jsx)(n.li,{children:"Backend verifies state contains valid session"}),"\n",(0,s.jsx)(n.li,{children:"Exchanges code for tokens"}),"\n",(0,s.jsx)(n.li,{children:"Stores encrypted credentials"}),"\n",(0,s.jsx)(n.li,{children:"Returns account email and merchant ID"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow-1",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (accountId: number) => {\n  if (!confirm("Disconnect this PayPal account?")) return;\n\n  const res = await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ accountId }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus("\u2705 PayPal disconnected");\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints-1",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Auth Required"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/paypal/auth"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Initiate OAuth"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/paypal/connect"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"OAuth callback (redirects)"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/paypal/connect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Exchange code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/paypal/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-details-1",children:"Key Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State Encoding"}),": Backend encodes session ID in base64 state parameter"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Dual Callback Handling"}),": Backend GET callback processes OAuth, or frontend can POST directly"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Session Validation"}),": State parameter verified against active session"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Success Indicators"}),": Check ",(0,s.jsx)(n.code,{children:"paypal=success"})," or ",(0,s.jsx)(n.code,{children:"paypal=error"})," query parameters"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"shopify-oauth-integration---frontend-documentation",children:"Shopify OAuth Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview-2",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Shopify OAuth requires the shop domain as input and uses HMAC signature verification for security. The flow includes backend HMAC validation before completing the connection."}),"\n",(0,s.jsx)(n.h2,{id:"oauth-flow-2",children:"OAuth Flow"}),"\n",(0,s.jsx)(n.h3,{id:"1-collect-shop-domain",children:"1. Collect Shop Domain"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const [shopDomain, setShopDomain] = useState("");\n\nconst handleShopifyAuth = () => {\n  if (!shopDomain) {\n    setError("Please enter your shop domain");\n    return;\n  }\n\n  const domain = shopDomain.includes(".myshopify.com")\n    ? shopDomain\n    : `${shopDomain}.myshopify.com`;\n\n  window.location.href = `${API_BASE}/auth?shop=${domain}`;\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:'User enters shop domain (e.g., "yourstore" or "yourstore.myshopify.com")'}),"\n",(0,s.jsxs)(n.li,{children:["Frontend normalizes to ",(0,s.jsx)(n.code,{children:".myshopify.com"})," format"]}),"\n",(0,s.jsxs)(n.li,{children:["Redirects to ",(0,s.jsx)(n.code,{children:"GET /api/v1/channels/shopify/auth?shop={domain}"})]}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-handle-oauth-callback-2",children:"2. Handle OAuth Callback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get("code");\n  const shop = params.get("shop");\n  const state = params.get("state");\n  const verified = params.get("verified");\n  const error = params.get("error");\n\n  if (error === "invalid_hmac") {\n    setError("Authentication failed: Invalid signature from Shopify");\n    window.history.replaceState({}, document.title, window.location.pathname);\n    return;\n  }\n\n  if (code && shop && state && verified === "true") {\n    connectShopify(shop, code, state);\n    window.history.replaceState({}, document.title, window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Shopify redirects to backend callback: ",(0,s.jsx)(n.code,{children:"/api/v1/channels/shopify/callback?code={code}&shop={shop}&state={state}&hmac={hmac}"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend verifies HMAC signature"}),"\n",(0,s.jsxs)(n.li,{children:["Backend redirects to frontend with ",(0,s.jsx)(n.code,{children:"verified=true"})," if valid, or ",(0,s.jsx)(n.code,{children:"error=invalid_hmac"})," if invalid"]}),"\n",(0,s.jsx)(n.li,{children:"Frontend proceeds to connection only if verified"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-complete-connection-2",children:"3. Complete Connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const connectShopify = async (shop: string, code: string, state: string) => {\n  setLoading(true);\n  setStatus("Connecting Shopify...");\n\n  const res = await fetch(`${API_BASE}/connect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ shop, code, state }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus(`\u2705 Shopify connected (${data.shopName})`);\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sends shop domain, code, and state to backend"}),"\n",(0,s.jsx)(n.li,{children:"Backend exchanges code for access token"}),"\n",(0,s.jsx)(n.li,{children:"Stores encrypted credentials and configures webhooks"}),"\n",(0,s.jsx)(n.li,{children:"Returns shop details"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow-2",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (storeId: number) => {\n  if (!confirm("Disconnect this Shopify store?")) return;\n\n  const res = await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ storeId }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus("\u2705 Shopify disconnected");\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:"Removes webhooks and deletes the store connection."}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints-2",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Auth Required"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/shopify/auth"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Initiate OAuth with shop domain"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/shopify/callback"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"No"}),(0,s.jsx)(n.td,{children:"Verify HMAC and redirect"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/shopify/connect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Exchange code for token"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/shopify/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-details-2",children:"Key Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Shop Domain Input"}),": Required before OAuth can begin"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"HMAC Verification"}),": Backend validates Shopify's signature before allowing connection"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Verified Parameter"}),": Frontend only proceeds if ",(0,s.jsx)(n.code,{children:"verified=true"})," is present"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Error Handling"}),": ",(0,s.jsx)(n.code,{children:"invalid_hmac"})," error indicates security validation failure"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State Parameter"}),": Used for CSRF protection"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"stripe-connect-oauth-integration---frontend-documentation",children:"Stripe Connect OAuth Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview-3",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Stripe Connect uses OAuth 2.0 with state parameter for CSRF protection. The integration connects Stripe accounts to enable payment processing within conversations."}),"\n",(0,s.jsx)(n.h2,{id:"oauth-flow-3",children:"OAuth Flow"}),"\n",(0,s.jsx)(n.h3,{id:"1-initiate-authentication-2",children:"1. Initiate Authentication"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleStripeAuth = () => {\n  setStatus("Redirecting to Stripe...");\n  window.location.href = `${API_BASE}/auth`;\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Redirects to ",(0,s.jsx)(n.code,{children:"GET /api/v1/channels/stripe/auth"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend generates OAuth URL with state parameter"}),"\n",(0,s.jsx)(n.li,{children:"Redirects to Stripe Connect authorization screen"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-handle-oauth-callback-3",children:"2. Handle OAuth Callback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get("code");\n  const state = params.get("state");\n\n  if (code && state) {\n    connectStripe(code, state);\n    window.history.replaceState({}, document.title, window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Stripe redirects back with ",(0,s.jsx)(n.code,{children:"code"})," and ",(0,s.jsx)(n.code,{children:"state"})," parameters"]}),"\n",(0,s.jsx)(n.li,{children:"Frontend extracts both values"}),"\n",(0,s.jsx)(n.li,{children:"Automatically triggers connection"}),"\n",(0,s.jsx)(n.li,{children:"Cleans parameters from URL"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-complete-connection-3",children:"3. Complete Connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const connectStripe = async (authCode: string, state: string) => {\n  setLoading(true);\n  setStatus("Connecting Stripe...");\n\n  const res = await fetch(`${API_BASE}/connect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ authCode, state }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus(`\u2705 Stripe connected (${data.stripeAccountId})`);\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"Process:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sends both authorization code and state to backend"}),"\n",(0,s.jsx)(n.li,{children:"Backend verifies state for CSRF protection"}),"\n",(0,s.jsx)(n.li,{children:"Exchanges code for access token"}),"\n",(0,s.jsx)(n.li,{children:"Stores account details and webhook configuration"}),"\n",(0,s.jsx)(n.li,{children:"Returns connected account ID"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow-3",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (accountId: number) => {\n  if (!confirm("Disconnect this Stripe account?")) return;\n\n  setLoading(true);\n\n  const res = await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ accountId }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  setStatus("\u2705 Stripe disconnected");\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:"Revokes Stripe access and removes the connected account."}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints-3",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Auth Required"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/stripe/auth"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Initiate OAuth flow"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/stripe/connect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Exchange code & state"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/stripe/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Yes (Session)"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-details-3",children:"Key Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State Parameter"}),": Required for CSRF protection, must be sent back to backend"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Authentication"}),": Session-based via cookies (",(0,s.jsx)(n.code,{children:'credentials: "include"'}),")"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Response Data"}),": Returns ",(0,s.jsx)(n.code,{children:"stripeAccountId"}),", ",(0,s.jsx)(n.code,{children:"accountType"}),", and ",(0,s.jsx)(n.code,{children:"scope"})]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"URL Cleanup"}),": Removes sensitive OAuth parameters after processing"]}),"\n"]}),"\n",(0,s.jsx)(n.h1,{id:"zoom-oauth-integration---frontend-documentation",children:"Zoom OAuth Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview-4",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"The Zoom integration uses OAuth 2.0 authorization code flow to connect user Zoom accounts. The frontend handles the OAuth redirect and exchanges the authorization code with the backend."}),"\n",(0,s.jsx)(n.h2,{id:"oauth-flow-4",children:"OAuth Flow"}),"\n",(0,s.jsx)(n.h3,{id:"1-initiate-authentication-3",children:"1. Initiate Authentication"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:"const handleZoomAuth = () => {\n  window.location.href = `${API_BASE}/auth`;\n};\n"})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What happens:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Redirects user to ",(0,s.jsx)(n.code,{children:"GET /api/v1/channels/zoom/auth"})]}),"\n",(0,s.jsx)(n.li,{children:"Backend generates OAuth URL and redirects to Zoom"}),"\n",(0,s.jsx)(n.li,{children:"User authorizes the application on Zoom's consent screen"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"2-handle-oauth-callback-4",children:"2. Handle OAuth Callback"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n  const code = params.get("zoom_code");\n\n  if (code) {\n    connectZoom(code);\n    // Clean up URL\n    window.history.replaceState({}, document.title, window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What happens:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:["Zoom redirects back to ",(0,s.jsx)(n.code,{children:"/integrations?zoom_code={authCode}"})]}),"\n",(0,s.jsxs)(n.li,{children:["Frontend extracts the ",(0,s.jsx)(n.code,{children:"zoom_code"})," parameter"]}),"\n",(0,s.jsx)(n.li,{children:"Automatically triggers connection process"}),"\n",(0,s.jsx)(n.li,{children:"Cleans the code from URL history"}),"\n"]}),"\n",(0,s.jsx)(n.h3,{id:"3-complete-connection-4",children:"3. Complete Connection"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const connectZoom = async (code: string) => {\n  setLoading(true);\n\n  const res = await fetch(`${API_BASE}/connect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ authCode: code }),\n  });\n\n  const data = await res.json();\n  if (!res.ok) throw new Error(data.message);\n\n  // Returns: { email: string, ... }\n  setStatus(`\u2705 Zoom connected (${data.email})`);\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:(0,s.jsx)(n.strong,{children:"What happens:"})}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsx)(n.li,{children:"Sends authorization code to backend"}),"\n",(0,s.jsx)(n.li,{children:"Backend exchanges code for access/refresh tokens"}),"\n",(0,s.jsx)(n.li,{children:"Stores encrypted credentials in database"}),"\n",(0,s.jsx)(n.li,{children:"Returns connected account details"}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow-4",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (accountId: number) => {\n  await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ accountId }),\n  });\n};\n'})}),"\n",(0,s.jsx)(n.p,{children:"Removes the Zoom account connection and revokes stored tokens."}),"\n",(0,s.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,s.jsx)(n.p,{children:"The callback endpoint handles errors via query parameters:"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'// On OAuth failure, Zoom redirects to:\n// /integrations?error=missing_code\n\nconst params = new URLSearchParams(window.location.search);\nconst error = params.get("error");\n'})}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-notes",children:"Key Implementation Notes"}),"\n",(0,s.jsxs)(n.ol,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Parameter naming"}),": Uses ",(0,s.jsx)(n.code,{children:"zoom_code"})," instead of generic ",(0,s.jsx)(n.code,{children:"code"})," to avoid conflicts with other OAuth integrations"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Credentials"}),": All API calls require ",(0,s.jsx)(n.code,{children:'credentials: "include"'})," for session authentication"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"URL cleanup"}),": Uses ",(0,s.jsx)(n.code,{children:"replaceState"})," to remove OAuth parameters after processing"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Security"}),": Authentication handled server-side via session cookies"]}),"\n"]}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints-4",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/zoom/auth"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Start OAuth flow"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/zoom/connect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Exchange auth code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/zoom/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h1,{id:"telegram-user-account-integration---frontend-documentation",children:"Telegram User Account Integration - Frontend Documentation"}),"\n",(0,s.jsx)(n.h2,{id:"overview-5",children:"Overview"}),"\n",(0,s.jsx)(n.p,{children:"Telegram integration supports two authentication methods: phone-based (multi-step) and QR code. Unlike other integrations, this uses Telegram's user account API (gramjs/MTProto), not bot API."}),"\n",(0,s.jsx)(n.h2,{id:"phone-authentication-flow",children:"Phone Authentication Flow"}),"\n",(0,s.jsx)(n.h3,{id:"step-1-send-code",children:"Step 1: Send Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handlePhoneAuth = async () => {\n  const res = await fetch(`${API_BASE}/connect/phone`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ phoneNumber }),\n  });\n\n  const data = await res.json();\n  setSessionId(data.sessionId);\n  setAwaitingCode(true);\n};\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Backend sends verification code via SMS/Telegram app and returns ",(0,s.jsx)(n.code,{children:"sessionId"})," for subsequent steps."]}),"\n",(0,s.jsx)(n.h3,{id:"step-2-verify-code",children:"Step 2: Verify Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleVerifyCode = async () => {\n  const res = await fetch(`${API_BASE}/connect/verify-code`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ sessionId, code }),\n  });\n\n  const data = await res.json();\n\n  if (data.passwordNeeded) {\n    setAwaiting2FA(true);\n  } else {\n    // Connection complete\n    await loadConnectedAccounts();\n  }\n};\n'})}),"\n",(0,s.jsxs)(n.p,{children:["If 2FA is enabled, response includes ",(0,s.jsx)(n.code,{children:"passwordNeeded: true"}),"."]}),"\n",(0,s.jsx)(n.h3,{id:"step-3-verify-2fa-if-needed",children:"Step 3: Verify 2FA (if needed)"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleVerify2FA = async () => {\n  const res = await fetch(`${API_BASE}/connect/verify-2fa`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ sessionId, password }),\n  });\n\n  // Connection complete\n  await loadConnectedAccounts();\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"qr-code-authentication-flow",children:"QR Code Authentication Flow"}),"\n",(0,s.jsx)(n.h3,{id:"generate-qr-code",children:"Generate QR Code"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleQRAuth = async () => {\n  const res = await fetch(`${API_BASE}/connect/qr`, {\n    method: "POST",\n    credentials: "include",\n  });\n\n  const data = await res.json();\n  setQrUrl(data.qrUrl);\n  setQrSessionId(data.sessionId);\n  startQRPolling(data.sessionId);\n};\n'})}),"\n",(0,s.jsx)(n.h3,{id:"poll-for-scan",children:"Poll for Scan"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const startQRPolling = (sessionId: string) => {\n  const interval = setInterval(async () => {\n    const res = await fetch(\n      `${API_BASE}/connect/qr/check?sessionId=${sessionId}`,\n      { credentials: "include" }\n    );\n\n    const data = await res.json();\n\n    if (data.success) {\n      clearInterval(interval);\n      await loadConnectedAccounts();\n    }\n  }, 2000);\n\n  // Timeout after 30 seconds\n  setTimeout(() => clearInterval(interval), 30000);\n};\n'})}),"\n",(0,s.jsxs)(n.p,{children:["Display QR as image: ",(0,s.jsx)(n.code,{children:"https://api.qrserver.com/v1/create-qr-code/?data=${qrUrl}"})]}),"\n",(0,s.jsx)(n.h2,{id:"disconnect-flow-5",children:"Disconnect Flow"}),"\n",(0,s.jsx)(n.pre,{children:(0,s.jsx)(n.code,{className:"language-typescript",children:'const handleDisconnect = async (accountId: number) => {\n  const res = await fetch(`${API_BASE}/disconnect`, {\n    method: "POST",\n    credentials: "include",\n    headers: { "Content-Type": "application/json" },\n    body: JSON.stringify({ accountId }),\n  });\n};\n'})}),"\n",(0,s.jsx)(n.h2,{id:"api-endpoints-5",children:"API Endpoints"}),"\n",(0,s.jsxs)(n.table,{children:[(0,s.jsx)(n.thead,{children:(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.th,{children:"Endpoint"}),(0,s.jsx)(n.th,{children:"Method"}),(0,s.jsx)(n.th,{children:"Purpose"})]})}),(0,s.jsxs)(n.tbody,{children:[(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/connect/phone"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Send verification code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/connect/verify-code"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Verify code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/connect/verify-2fa"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Verify 2FA password"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/connect/qr"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Generate QR code"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/connect/qr/check"})}),(0,s.jsx)(n.td,{children:"GET"}),(0,s.jsx)(n.td,{children:"Poll QR status"})]}),(0,s.jsxs)(n.tr,{children:[(0,s.jsx)(n.td,{children:(0,s.jsx)(n.code,{children:"/api/v1/channels/telegram/disconnect"})}),(0,s.jsx)(n.td,{children:"POST"}),(0,s.jsx)(n.td,{children:"Remove connection"})]})]})]}),"\n",(0,s.jsx)(n.h2,{id:"key-implementation-details-4",children:"Key Implementation Details"}),"\n",(0,s.jsxs)(n.ul,{children:["\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Multi-step auth"}),": Phone flow requires 2-3 API calls"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"Session tracking"}),": ",(0,s.jsx)(n.code,{children:"sessionId"})," persists across verification steps"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"QR polling"}),": Poll every 2 seconds with 30-second timeout"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"2FA detection"}),": Backend indicates if password needed"]}),"\n",(0,s.jsxs)(n.li,{children:[(0,s.jsx)(n.strong,{children:"State management"}),": Track current step (code/2FA/complete)"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,c.R)(),...e.components};return n?(0,s.jsx)(n,{...e,children:(0,s.jsx)(l,{...e})}):l(e)}},8453:(e,n,t)=>{t.d(n,{R:()=>o,x:()=>d});var i=t(6540);const s={},c=i.createContext(s);function o(e){const n=i.useContext(c);return i.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function d(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(s):e.components||s:o(e.components),i.createElement(c.Provider,{value:n},e.children)}}}]);