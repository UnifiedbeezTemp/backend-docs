"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[3996],{3419:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>d,contentTitle:()=>r,default:()=>h,frontMatter:()=>c,metadata:()=>a,toc:()=>t});const a=JSON.parse('{"id":"channels-integration/get-all-channels-with-access","title":"Get All Channels with Access Metadata - API Documentation","description":"Endpoint","source":"@site/docs/channels-integration/get-all-channels-with-access.md","sourceDirName":"channels-integration","slug":"/channels-integration/get-all-channels-with-access","permalink":"/backend-docs/docs/channels-integration/get-all-channels-with-access","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/channels-integration/get-all-channels-with-access.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"Channel Icon Cross-Reference: API Documentation","permalink":"/backend-docs/docs/channels-integration/channel-icon-cross-reference"},"next":{"title":"New Copilot Onboarding - Frontend Integration Guide","permalink":"/backend-docs/docs/copilot/new-copilot-integration"}}');var i=s(4848),l=s(8453);const c={},r="Get All Channels with Access Metadata - API Documentation",d={},t=[{value:"Endpoint",id:"endpoint",level:2},{value:"Description",id:"description",level:2},{value:"Authentication",id:"authentication",level:2},{value:"Access Status Logic",id:"access-status-logic",level:2},{value:"<code>access.allowed = true</code>",id:"accessallowed--true",level:3},{value:"<code>access.allowed = false</code>",id:"accessallowed--false",level:3},{value:"Communication Channel Limits",id:"communication-channel-limits",level:2},{value:"Example Response",id:"example-response",level:2},{value:"Frontend Implementation Guide",id:"frontend-implementation-guide",level:2},{value:"1. Display Channel Cards",id:"1-display-channel-cards",level:3},{value:"2. Upgrade CTA Logic",id:"2-upgrade-cta-logic",level:3},{value:"3. Channel Limit Warning",id:"3-channel-limit-warning",level:3},{value:"4. Filter/Sort Channels",id:"4-filtersort-channels",level:3},{value:"Use Cases",id:"use-cases",level:2}];function o(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"get-all-channels-with-access-metadata---api-documentation",children:"Get All Channels with Access Metadata - API Documentation"})}),"\n",(0,i.jsx)(n.h2,{id:"endpoint",children:"Endpoint"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"GET /channels/available/all\n"})}),"\n",(0,i.jsx)(n.h2,{id:"description",children:"Description"}),"\n",(0,i.jsxs)(n.p,{children:["Returns all active channels with detailed access information for the current user. Unlike ",(0,i.jsx)(n.code,{children:"/channels/available"})," which filters out inaccessible channels, this endpoint shows everything and indicates why certain channels are blocked."]}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["Requires authentication via session cookie ",(0,i.jsx)(n.code,{children:"credentials: include"})," header."]}),"\n",(0,i.jsx)(n.h2,{id:"access-status-logic",children:"Access Status Logic"}),"\n",(0,i.jsx)(n.h3,{id:"accessallowed--true",children:(0,i.jsx)(n.code,{children:"access.allowed = true"})}),"\n",(0,i.jsx)(n.p,{children:"User can select and connect this channel. No upgrade needed."}),"\n",(0,i.jsx)(n.h3,{id:"accessallowed--false",children:(0,i.jsx)(n.code,{children:"access.allowed = false"})}),"\n",(0,i.jsxs)(n.p,{children:["User cannot access this channel. Check ",(0,i.jsx)(n.code,{children:"blockedBy"})," field:"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'blockedBy: "plan"'})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User's plan is insufficient"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requiredPlans"}),": Array of plans that unlock this channel"]}),"\n",(0,i.jsx)(n.li,{children:'Show: "Requires [BUSINESS] plan" or "Requires [BUSINESS or PREMIUM] plan"'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'blockedBy: "addon"'})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User has correct plan but missing addon"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requiredAddon"}),': Specific addon needed (e.g., "CRM_CALENDAR_SYNC")']}),"\n",(0,i.jsx)(n.li,{children:'Show: "Requires CRM Calendar Sync addon"'}),"\n"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:(0,i.jsx)(n.code,{children:'blockedBy: "both"'})})}),"\n",(0,i.jsxs)(n.ul,{children:["\n",(0,i.jsx)(n.li,{children:"User needs both plan upgrade AND addon"}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.code,{children:"requiredPlans"})," + ",(0,i.jsx)(n.code,{children:"requiredAddon"})," both populated"]}),"\n",(0,i.jsx)(n.li,{children:'Show: "Requires [BUSINESS] plan and CRM Calendar Sync addon"'}),"\n"]}),"\n",(0,i.jsx)(n.h2,{id:"communication-channel-limits",children:"Communication Channel Limits"}),"\n",(0,i.jsxs)(n.p,{children:["For ",(0,i.jsx)(n.code,{children:"communication"})," category only, the ",(0,i.jsx)(n.code,{children:"limits"})," object contains:"]}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  current: 2,        // Channels user has selected\n  max: 5,           // Maximum allowed (null if unlimited)\n  unlimited: false,  // Whether user has unlimited channels\n  remaining: 3      // Slots available (null if unlimited)\n}\n"})}),"\n",(0,i.jsx)(n.h2,{id:"example-response",children:"Example Response"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-json",children:'{\n  "userPlan": "INDIVIDUAL",\n  "categories": {\n    "communication": {\n      "channels": [\n        {\n          "id": 1,\n          "name": "whatsapp",\n          "displayName": "WhatsApp Business",\n          "description": "Connect WhatsApp Business API for messaging",\n          "category": "COMMUNICATION",\n          "channelType": "WHATSAPP",\n          "requiresPlan": ["BUSINESS", "PREMIUM", "ORGANISATION"],\n          "requiresAddon": null,\n          "access": {\n            "allowed": false,\n            "blockedBy": "plan",\n            "requiredPlans": ["BUSINESS", "PREMIUM", "ORGANISATION"],\n            "requiredAddon": null,\n            "reason": "Requires BUSINESS or PREMIUM or ORGANISATION plan"\n          }\n        },\n        {\n          "id": 3,\n          "name": "facebook_messenger",\n          "displayName": "Facebook Messenger",\n          "description": "Connect Facebook Page for messaging",\n          "category": "COMMUNICATION",\n          "channelType": "FACEBOOK_MESSENGER",\n          "requiresPlan": ["INDIVIDUAL", "BUSINESS", "PREMIUM", "ORGANISATION"],\n          "requiresAddon": null,\n          "access": {\n            "allowed": true,\n            "blockedBy": null,\n            "requiredPlans": null,\n            "requiredAddon": null,\n            "reason": null\n          }\n        }\n      ],\n      "limits": {\n        "current": 2,\n        "max": 5,\n        "unlimited": false,\n        "remaining": 3\n      }\n    },\n    "crmCalendar": {\n      "channels": [\n        {\n          "id": 11,\n          "name": "google_calendar",\n          "displayName": "Google Calendar",\n          "description": "Sync meetings and availability",\n          "category": "CRM_CALENDAR",\n          "channelType": "CALENDAR",\n          "requiresPlan": ["BUSINESS", "PREMIUM", "ORGANISATION"],\n          "requiresAddon": "CRM_CALENDAR_SYNC",\n          "access": {\n            "allowed": false,\n            "blockedBy": "both",\n            "requiredPlans": ["BUSINESS", "PREMIUM", "ORGANISATION"],\n            "requiredAddon": "CRM_CALENDAR_SYNC",\n            "reason": "Requires BUSINESS or PREMIUM or ORGANISATION plan and CRM_CALENDAR_SYNC addon"\n          }\n        }\n      ],\n      "limits": {\n        "message": "Feature-based access"\n      }\n    }\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h2,{id:"frontend-implementation-guide",children:"Frontend Implementation Guide"}),"\n",(0,i.jsx)(n.h3,{id:"1-display-channel-cards",children:"1. Display Channel Cards"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"channels.map((channel) => {\n  const isAccessible = channel.access.allowed;\n  const isLocked = !isAccessible;\n\n  return (\n    <ChannelCard\n      channel={channel}\n      locked={isLocked}\n      lockReason={channel.access.reason}\n      onUpgrade={() => handleUpgrade(channel.access)}\n    />\n  );\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"2-upgrade-cta-logic",children:"2. Upgrade CTA Logic"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'function getUpgradeCTA(access: AccessMetadata) {\n  if (access.blockedBy === "plan") {\n    return {\n      text: "Upgrade Plan",\n      action: "SHOW_PLAN_MODAL",\n      plans: access.requiredPlans,\n    };\n  }\n\n  if (access.blockedBy === "addon") {\n    return {\n      text: "Add Feature",\n      action: "SHOW_ADDON_MODAL",\n      addon: access.requiredAddon,\n    };\n  }\n\n  if (access.blockedBy === "both") {\n    return {\n      text: "Upgrade Required",\n      action: "SHOW_UPGRADE_MODAL",\n      plans: access.requiredPlans,\n      addon: access.requiredAddon,\n    };\n  }\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"3-channel-limit-warning",children:"3. Channel Limit Warning"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const { limits } = categories.communication;\n\nif (!limits.unlimited && limits.remaining === 0) {\n  showWarning("Channel limit reached. Upgrade to add more channels.");\n}\n\nif (!limits.unlimited && limits.remaining <= 2) {\n  showInfo(`${limits.remaining} channel slots remaining`);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"4-filtersort-channels",children:"4. Filter/Sort Channels"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"// Show accessible first\nconst sorted = channels.sort(\n  (a, b) => Number(b.access.allowed) - Number(a.access.allowed)\n);\n\n// Group by access status\nconst accessible = channels.filter((c) => c.access.allowed);\nconst locked = channels.filter((c) => !c.access.allowed);\n"})}),"\n",(0,i.jsx)(n.h2,{id:"use-cases",children:"Use Cases"}),"\n",(0,i.jsxs)(n.ol,{children:["\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Channel selection page"}),": Show all channels with visual indicators (lock icon, upgrade badge)"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Upgrade prompts"}),": Direct users to specific plan or addon based on ",(0,i.jsx)(n.code,{children:"blockedBy"})]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Feature discovery"}),": Let users see what they're missing without hiding it"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Limit tracking"}),": Show progress bars for communication channel usage"]}),"\n",(0,i.jsxs)(n.li,{children:[(0,i.jsx)(n.strong,{children:"Smart upselling"}),": Target messaging based on which channels user wants but can't access"]}),"\n"]})]})}function h(e={}){const{wrapper:n}={...(0,l.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(o,{...e})}):o(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>c,x:()=>r});var a=s(6540);const i={},l=a.createContext(i);function c(e){const n=a.useContext(l);return a.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function r(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:c(e.components),a.createElement(l.Provider,{value:n},e.children)}}}]);