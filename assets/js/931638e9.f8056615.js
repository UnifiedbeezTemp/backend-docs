"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[5913],{949:(e,n,s)=>{s.r(n),s.d(n,{assets:()=>l,contentTitle:()=>c,default:()=>p,frontMatter:()=>a,metadata:()=>t,toc:()=>o});const t=JSON.parse('{"id":"copilot-integration","title":"Copilot Onboarding - Frontend Integration Guide","description":"Base URL","source":"@site/docs/copilot-integration.md","sourceDirName":".","slug":"/copilot-integration","permalink":"/backend-docs/docs/copilot-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/copilot-integration.md","tags":[],"version":"current","sidebarPosition":10,"frontMatter":{"sidebar_position":10},"sidebar":"tutorialSidebar","previous":{"title":"Custom Email (AWS SES) Integration Guide","permalink":"/backend-docs/docs/custom-email-integration"}}');var i=s(4848),r=s(8453);const a={sidebar_position:10},c="Copilot Onboarding - Frontend Integration Guide",l={},o=[{value:"Base URL",id:"base-url",level:2},{value:"Authentication",id:"authentication",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"1. Start Conversation",id:"1-start-conversation",level:3},{value:"2. Send Message",id:"2-send-message",level:3},{value:"3. Edit Previous Step",id:"3-edit-previous-step",level:3},{value:"4. Skip Substep",id:"4-skip-substep",level:3},{value:"5. Get Current State",id:"5-get-current-state",level:3},{value:"6. Restart Conversation",id:"6-restart-conversation",level:3},{value:"7. Change Plan",id:"7-change-plan",level:3},{value:"8. AI Assist (Optional)",id:"8-ai-assist-optional",level:3},{value:"Frontend Flow",id:"frontend-flow",level:2},{value:"Initial Load",id:"initial-load",level:3},{value:"User Responds",id:"user-responds",level:3},{value:"Handle Special Cases",id:"handle-special-cases",level:3},{value:"UI Directives Reference",id:"ui-directives-reference",level:2},{value:"Special Substeps Handling",id:"special-substeps-handling",level:2},{value:"planConfirmation",id:"planconfirmation",level:3},{value:"changePlan",id:"changeplan",level:3},{value:"categoryNotListed",id:"categorynotlisted",level:3},{value:"businessName",id:"businessname",level:3},{value:"selectBusinessNameMatch",id:"selectbusinessnamematch",level:3},{value:"confirmBusinessData",id:"confirmbusinessdata",level:3},{value:"businessNotListed",id:"businessnotlisted",level:3},{value:"beezaroAssistants",id:"beezaroassistants",level:3},{value:"Progress Tracking",id:"progress-tracking",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"State Persistence",id:"state-persistence",level:2},{value:"TypeScript Types",id:"typescript-types",level:2},{value:"Testing Checklist",id:"testing-checklist",level:2}];function d(e){const n={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",input:"input",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(n.header,{children:(0,i.jsx)(n.h1,{id:"copilot-onboarding---frontend-integration-guide",children:"Copilot Onboarding - Frontend Integration Guide"})}),"\n",(0,i.jsx)(n.h2,{id:"base-url",children:"Base URL"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{children:"/copilot\n"})}),"\n",(0,i.jsx)(n.h2,{id:"authentication",children:"Authentication"}),"\n",(0,i.jsxs)(n.p,{children:["All endpoints require JWT authentication via ",(0,i.jsx)(n.code,{children:"SessionAuthGuard"}),"."]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,i.jsx)(n.h3,{id:"1-start-conversation",children:"1. Start Conversation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/start"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Initialize new copilot onboarding session"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  botMessage: string;\n  currentSubstep: {\n    id: string;\n    name: string;\n    type: 'choice' | 'input' | 'custom' | 'button';\n    botMessage: string;\n    options?: Array<{\n      label: string;\n      value: any;\n      type: 'radio' | 'select' | 'button';\n      emoji?: string;\n      nextSubstepId?: string;\n      isCustom?: boolean;\n    }>;\n    attachment?: {\n      name: string;\n      data: any;\n    };\n    canEdit?: boolean;\n    canSkip?: boolean;\n  };\n  uiDirectives?: {\n    showAttachment?: boolean;\n    [key: string]: any;\n  };\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const response = await fetch("/copilot/start", {\n  method: "POST",\n  headers: { Authorization: `Bearer ${token}` },\n});\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"2-send-message",children:"2. Send Message"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/message"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Send user response (selection, text input, file upload)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  content: string;                    // User's selection/input value\n  inputType?: 'text' | 'selection' | 'file';\n  metadata?: {\n    selectedOption?: any;\n    formField?: string;\n    [key: string]: any;\n  };\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response:"})," Same as ",(0,i.jsx)(n.code,{children:"/start"})," response"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Examples:"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Selection:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'await fetch("/copilot/message", {\n  method: "POST",\n  headers: { "Content-Type": "application/json" },\n  body: JSON.stringify({\n    content: "HEALTHCARE_CLINICS",\n    inputType: "selection",\n    metadata: {\n      selectedOption: "HEALTHCARE_CLINICS",\n      formField: "industry",\n    },\n  }),\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Text Input:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'await fetch("/copilot/message", {\n  method: "POST",\n  body: JSON.stringify({\n    content: "Dental Care Plus",\n    inputType: "text",\n    metadata: { formField: "businessName" },\n  }),\n});\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"General Chat:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// User types: "I run a dental clinic"\nawait fetch("/copilot/message", {\n  method: "POST",\n  body: JSON.stringify({\n    content: "I run a dental clinic",\n    inputType: "text",\n    // No formField = triggers AI intent recognition\n  }),\n});\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"3-edit-previous-step",children:"3. Edit Previous Step"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/edit/:substepId"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Go back and change a previous answer"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  substepId: string; // Also in URL param\n  newValue: any;\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  botMessage: string;\n  currentSubstep: object;\n  uiDirectives?: {\n    requiresReconfiguration?: string[];  // Affected substep IDs\n  };\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// User wants to change team size\nawait fetch("/copilot/edit/teamSize", {\n  method: "POST",\n  body: JSON.stringify({\n    substepId: "teamSize",\n    newValue: "6-20",\n  }),\n});\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"4-skip-substep",children:"4. Skip Substep"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/skip"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Skip current substep (if allowed)"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  substepId: string;\n}\n"})}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response:"})," Same as ",(0,i.jsx)(n.code,{children:"/message"})," response"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"5-get-current-state",children:"5. Get Current State"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"GET"})," ",(0,i.jsx)(n.code,{children:"/copilot/state"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Retrieve current conversation state and progress"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  conversationId: number;\n  currentSection: string;\n  currentSubstep: string;\n  sessionState: {\n    current_section: string;\n    current_substep: string;\n    last_interaction: string;\n    collected_data: {\n      confirmed_plan?: boolean;\n      selected_plan?: 'INDIVIDUAL' | 'BUSINESS' | 'PREMIUM' | 'ORGANISATION';\n      industry?: string;\n      business_name?: string;\n      selected_business?: {\n        name: string;\n        address?: string;\n        phone?: string;\n        email?: string;\n        website?: string;\n        logo_url?: string;\n      };\n      team_size?: string;\n      team_members?: Array<{ email: string; name?: string; role?: string }>;\n      selected_channels?: string[];\n      no_reply_action?: 'wait' | 'escalate' | 'followUp';\n      ai_setup_type?: 'single' | 'multiple';\n      selected_automations?: string[];\n    };\n    completed_sections: string[];\n    completed_substeps: string[];\n    skipped_substeps: string[];\n    edit_history: Array<{\n      section: string;\n      substep: string;\n      field: string;\n      old_value: any;\n      new_value: any;\n      timestamp: string;\n      affected_substeps?: string[];\n    }>;\n  };\n  isActive: boolean;\n  isCompleted: boolean;\n  recentMessages: Array<{\n    messageType: 'USER_INPUT' | 'USER_SELECTION' | 'USER_EDIT' | 'AI_RESPONSE' | 'SECTION_COMPLETE' | 'SYSTEM';\n    content: string;\n    metadata: any;\n    createdAt: string;\n  }>;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"6-restart-conversation",children:"6. Restart Conversation"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/restart"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Mark current conversation inactive and start fresh"]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Response:"})," Same as ",(0,i.jsx)(n.code,{children:"/start"})," response"]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"7-change-plan",children:"7. Change Plan"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/change-plan"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Switch user's plan mid-onboarding"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'{\n  newPlan: "INDIVIDUAL" | "BUSINESS" | "PREMIUM" | "ORGANISATION";\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Response:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  botMessage: string;\n  currentSubstep: object;\n  uiDirectives?: {\n    requiresReconfiguration?: string[];\n  };\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Example:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// User clicks "Change plan" button\nawait fetch("/copilot/change-plan", {\n  method: "POST",\n  body: JSON.stringify({\n    newPlan: "BUSINESS",\n  }),\n});\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h3,{id:"8-ai-assist-optional",children:"8. AI Assist (Optional)"}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"POST"})," ",(0,i.jsx)(n.code,{children:"/copilot/ai-assist"})]}),"\n",(0,i.jsxs)(n.p,{children:[(0,i.jsx)(n.strong,{children:"Description:"})," Direct access to Python Lambda AI services"]}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Request Body:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"{\n  action: 'suggest_industry' | 'generate_goals_objectives' | 'parse_intent';\n  user_input: string;\n  context?: any;\n}\n"})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"frontend-flow",children:"Frontend Flow"}),"\n",(0,i.jsx)(n.h3,{id:"initial-load",children:"Initial Load"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// 1. Start conversation\nconst { botMessage, currentSubstep } = await POST("/copilot/start");\n\n// 2. Display bot message\ndisplayMessage(botMessage);\n\n// 3. Render UI based on substep type\nif (currentSubstep.type === "choice") {\n  renderOptions(currentSubstep.options);\n} else if (currentSubstep.type === "input") {\n  renderTextInput();\n} else if (currentSubstep.type === "custom") {\n  renderCustomComponent(currentSubstep.attachment.name);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"user-responds",children:"User Responds"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// User selects option or enters text\nconst response = await POST("/copilot/message", {\n  content: userSelection,\n  inputType: "selection",\n  metadata: {\n    selectedOption: userSelection,\n    formField: currentSubstep.formField,\n  },\n});\n\n// Update UI\ndisplayMessage(response.botMessage);\nrenderSubstep(response.currentSubstep);\n'})}),"\n",(0,i.jsx)(n.h3,{id:"handle-special-cases",children:"Handle Special Cases"}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Plan Upgrade Prompt:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (response.uiDirectives?.showPlanUpgrade) {\n  showModal({\n    message: response.botMessage,\n    suggestedPlan: response.uiDirectives.suggestedPlan,\n    onUpgrade: () =>\n      POST("/copilot/change-plan", {\n        newPlan: response.uiDirectives.suggestedPlan,\n      }),\n  });\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Reconfiguration Required:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (response.uiDirectives?.requiresReconfiguration) {\n  const affectedSteps = response.uiDirectives.requiresReconfiguration;\n  showNotification(`Changes affect: ${affectedSteps.join(", ")}`);\n  // Backend automatically redirects to first affected step\n}\n'})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Section Complete:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"if (response.sectionComplete) {\n  showSectionCompleteAnimation();\n  updateProgressBar(sessionState.completed_sections.length / 6);\n}\n"})}),"\n",(0,i.jsx)(n.p,{children:(0,i.jsx)(n.strong,{children:"Conversation Complete:"})}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (response.conversationComplete) {\n  redirectTo("/dashboard");\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"ui-directives-reference",children:"UI Directives Reference"}),"\n",(0,i.jsxs)(n.table,{children:[(0,i.jsx)(n.thead,{children:(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.th,{children:"Directive"}),(0,i.jsx)(n.th,{children:"Type"}),(0,i.jsx)(n.th,{children:"When Used"})]})}),(0,i.jsxs)(n.tbody,{children:[(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"showPlanUpgrade"})}),(0,i.jsx)(n.td,{children:"boolean"}),(0,i.jsx)(n.td,{children:"User selection exceeds current plan"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"suggestedPlan"})}),(0,i.jsx)(n.td,{children:"PlanType"}),(0,i.jsx)(n.td,{children:"Which plan to upgrade to"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"showAttachment"})}),(0,i.jsx)(n.td,{children:"object"}),(0,i.jsx)(n.td,{children:"Render special UI component"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"highlightOption"})}),(0,i.jsx)(n.td,{children:"string"}),(0,i.jsx)(n.td,{children:"Auto-suggest from AI parsing"})]}),(0,i.jsxs)(n.tr,{children:[(0,i.jsx)(n.td,{children:(0,i.jsx)(n.code,{children:"requiresReconfiguration"})}),(0,i.jsx)(n.td,{children:"string[]"}),(0,i.jsx)(n.td,{children:"Edit triggered reconfiguration"})]})]})]}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"special-substeps-handling",children:"Special Substeps Handling"}),"\n",(0,i.jsx)(n.h3,{id:"planconfirmation",children:"planConfirmation"}),"\n",(0,i.jsx)(n.p,{children:"Shows plan summary attachment:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (currentSubstep.attachment?.name === "planSummary") {\n  renderPlanSummary(userData.plan);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"changeplan",children:"changePlan"}),"\n",(0,i.jsx)(n.p,{children:"Shows available plans:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (currentSubstep.attachment?.name === "plansPreview") {\n  const plans = await fetchPlans(); // Your existing plans API\n  renderPlansGrid(plans);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"categorynotlisted",children:"categoryNotListed"}),"\n",(0,i.jsx)(n.p,{children:"Text input triggers AI suggestion:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// User types business description\nconst response = await POST("/copilot/message", {\n  content: "I run a dental clinic",\n  inputType: "text",\n});\n\n// Backend returns suggested industry with highlight\nif (response.uiDirectives?.highlightOption) {\n  highlightIndustryChip(response.uiDirectives.highlightOption);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"businessname",children:"businessName"}),"\n",(0,i.jsx)(n.p,{children:"After input, searches for matches:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'const response = await POST("/copilot/message", {\n  content: "Dental Care Plus",\n  metadata: { formField: "businessName" },\n});\n\n// Backend automatically searches and moves to selectBusinessNameMatch\n// Next substep shows business options\n'})}),"\n",(0,i.jsx)(n.h3,{id:"selectbusinessnamematch",children:"selectBusinessNameMatch"}),"\n",(0,i.jsx)(n.p,{children:"Shows scraped business data:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:"currentSubstep.options.forEach((business) => {\n  renderBusinessCard({\n    name: business.label,\n    details: business.value, // Contains address, phone, email, website, logo\n  });\n});\n"})}),"\n",(0,i.jsx)(n.h3,{id:"confirmbusinessdata",children:"confirmBusinessData"}),"\n",(0,i.jsx)(n.p,{children:"Shows business data preview:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (currentSubstep.attachment?.name === "businessDataPreview") {\n  renderBusinessPreview(sessionState.collected_data.selected_business);\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"businessnotlisted",children:"businessNotListed"}),"\n",(0,i.jsx)(n.p,{children:"File upload for logo:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (currentSubstep.attachment?.name === "logoUpload") {\n  renderFileUploader({\n    accept: "image/*",\n    onUpload: async (file) => {\n      const logoUrl = await uploadToS3(file);\n      await POST("/copilot/message", {\n        content: logoUrl,\n        metadata: { formField: "business_logo" },\n      });\n    },\n  });\n}\n'})}),"\n",(0,i.jsx)(n.h3,{id:"beezaroassistants",children:"beezaroAssistants"}),"\n",(0,i.jsx)(n.p,{children:"Shows recommended AI assistants:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'if (currentSubstep.attachment?.name === "beezaroAssistants") {\n  renderAssistantsList(currentSubstep.attachment.data.assistants);\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"progress-tracking",children:"Progress Tracking"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// Get state to show progress\nconst state = await GET("/copilot/state");\n\nconst progress = {\n  currentSection: state.currentSection,\n  completedSections: state.sessionState.completed_sections,\n  totalSections: 6,\n  percentage: (state.sessionState.completed_sections.length / 6) * 100,\n};\n\nrenderProgressBar(progress);\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'try {\n  const response = await POST("/copilot/message", data);\n} catch (error) {\n  if (error.status === 404) {\n    // No active conversation\n    redirectTo("/copilot/start");\n  } else if (error.status === 400) {\n    // Invalid input\n    showError(error.message);\n  } else {\n    // Server error\n    showError("Something went wrong. Please try again.");\n  }\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"state-persistence",children:"State Persistence"}),"\n",(0,i.jsx)(n.p,{children:"Backend handles all state persistence. Frontend can refresh/navigate away safely:"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'// On page load\nconst state = await GET("/copilot/state");\n\nif (state.isCompleted) {\n  redirectTo("/dashboard");\n} else if (state.isActive) {\n  // Resume from current position\n  displaySubstep(state.currentSubstep);\n} else {\n  // No conversation - start new\n  redirectTo("/copilot/start");\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"typescript-types",children:"TypeScript Types"}),"\n",(0,i.jsx)(n.pre,{children:(0,i.jsx)(n.code,{className:"language-typescript",children:'type PlanType = "INDIVIDUAL" | "BUSINESS" | "PREMIUM" | "ORGANISATION";\n\ntype SubstepType = "choice" | "input" | "custom" | "button";\n\ninterface SubstepOption {\n  label: string;\n  value: any;\n  type: "radio" | "select" | "button";\n  emoji?: string;\n  nextSubstepId?: string;\n  isCustom?: boolean;\n  recommended?: boolean;\n  hasSubselect?: boolean;\n  options?: SubstepOption[];\n}\n\ninterface Substep {\n  id: string;\n  name: string;\n  type: SubstepType;\n  botMessage: string;\n  options?: SubstepOption[];\n  attachment?: {\n    name: string;\n    data: any;\n  };\n  canEdit?: boolean;\n  canSkip?: boolean;\n  formField?: string;\n  isEndOfStep?: boolean;\n}\n\ninterface CopilotResponse {\n  botMessage: string;\n  currentSubstep: Substep;\n  nextSubstepId?: string;\n  uiDirectives?: {\n    showPlanUpgrade?: boolean;\n    suggestedPlan?: PlanType;\n    highlightOption?: string;\n    requiresReconfiguration?: string[];\n    showAttachment?: { name: string; data: any };\n  };\n  sectionComplete?: boolean;\n  conversationComplete?: boolean;\n}\n'})}),"\n",(0,i.jsx)(n.hr,{}),"\n",(0,i.jsx)(n.h2,{id:"testing-checklist",children:"Testing Checklist"}),"\n",(0,i.jsxs)(n.ul,{className:"contains-task-list",children:["\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Start conversation displays first substep"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Button selections advance flow"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Text inputs work correctly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","General chat triggers AI parsing"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Plan upgrade modal appears when needed"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Edit redirects to previous step"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Skip hides dependent substeps"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Section completion shows animation"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Progress bar updates correctly"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","State persists across refreshes"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Restart clears and begins fresh"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Completion redirects to dashboard"]}),"\n",(0,i.jsxs)(n.li,{className:"task-list-item",children:[(0,i.jsx)(n.input,{type:"checkbox",disabled:!0})," ","Error states handled gracefully"]}),"\n"]})]})}function p(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,i.jsx)(n,{...e,children:(0,i.jsx)(d,{...e})}):d(e)}},8453:(e,n,s)=>{s.d(n,{R:()=>a,x:()=>c});var t=s(6540);const i={},r=t.createContext(i);function a(e){const n=t.useContext(r);return t.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function c(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(i):e.components||i:a(e.components),t.createElement(r.Provider,{value:n},e.children)}}}]);