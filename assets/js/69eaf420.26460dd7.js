"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[6726],{3748:(n,e,a)=>{a.r(e),a.d(e,{assets:()=>r,contentTitle:()=>c,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>t});const s=JSON.parse('{"id":"addon-integration","title":"Addon System - Frontend Integration Guide","description":"Core Concepts","source":"@site/docs/addon-integration.md","sourceDirName":".","slug":"/addon-integration","permalink":"/backend-docs/docs/addon-integration","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/addon-integration.md","tags":[],"version":"current","frontMatter":{},"sidebar":"tutorialSidebar","previous":{"title":"\ud83d\udd10 Two-Factor Authentication (2FA) \u2013 Frontend Integration Guide","permalink":"/backend-docs/docs/2fa-auth-integration"},"next":{"title":"Apple Sign In Integration Guide","permalink":"/backend-docs/docs/apple-integration"}}');var d=a(4848),l=a(8453);const i={},c="Addon System - Frontend Integration Guide",r={},t=[{value:"Core Concepts",id:"core-concepts",level:2},{value:"API Endpoints",id:"api-endpoints",level:2},{value:"Get Available Addons",id:"get-available-addons",level:3},{value:"Purchase Addon",id:"purchase-addon",level:3},{value:"Get Purchased Addons",id:"get-purchased-addons",level:3},{value:"Cancel Addon",id:"cancel-addon",level:3},{value:"Immediate Cancel (Admin)",id:"immediate-cancel-admin",level:3},{value:"Batch Purchase",id:"batch-purchase",level:3},{value:"Check Free Allowance",id:"check-free-allowance",level:3},{value:"Language-Specific Endpoints",id:"language-specific-endpoints",level:3},{value:"Response Fields",id:"response-fields",level:2},{value:"Validation Rules",id:"validation-rules",level:2},{value:"Error Handling",id:"error-handling",level:2},{value:"UI Patterns",id:"ui-patterns",level:2},{value:"Display Purchased Addons",id:"display-purchased-addons",level:3},{value:"MULTI_LANGUAGE_AI Instance List",id:"multi_language_ai-instance-list",level:3},{value:"Purchase Flow",id:"purchase-flow",level:3},{value:"Quantity Limits",id:"quantity-limits",level:3},{value:"State Management",id:"state-management",level:2},{value:"Plan Integration",id:"plan-integration",level:2}];function o(n){const e={code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,l.R)(),...n.components};return(0,d.jsxs)(d.Fragment,{children:[(0,d.jsx)(e.header,{children:(0,d.jsx)(e.h1,{id:"addon-system---frontend-integration-guide",children:"Addon System - Frontend Integration Guide"})}),"\n",(0,d.jsx)(e.h2,{id:"core-concepts",children:"Core Concepts"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Addon Types:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Quantifiable"}),": EXTRA_SEAT, EXTRA_AI_ASSISTANT, TWILIO_MESSAGE_PACK (have quantities)"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Feature"}),": CRM_CALENDAR_SYNC, ECOMMERCE_PACK (binary - you have it or don't)"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.strong,{children:"Special"}),": MULTI_LANGUAGE_AI (one instance per language)"]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Addon States:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"active"}),": Currently usable"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"scheduledForCancellation"}),": Active until ",(0,d.jsx)(e.code,{children:"expiresAt"}),", then deactivates"]}),"\n",(0,d.jsxs)(e.li,{children:["Plan limits apply to ",(0,d.jsx)(e.code,{children:"active"})," count only"]}),"\n"]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"api-endpoints",children:"API Endpoints"}),"\n",(0,d.jsx)(e.h3,{id:"get-available-addons",children:"Get Available Addons"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:"GET /addon/available\n"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Response:"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-json",children:'{\n  "addons": [\n    {\n      "id": 1,\n      "type": "EXTRA_SEAT",\n      "name": "Extra Seat",\n      "priceEur": 700,\n      "currentQuantity": 3,\n      "basePlanAllowance": 5,\n      "maxAllowed": 10,\n      "remainingPurchasable": 2,\n      "isIncludedInPlan": false\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(e.h3,{id:"purchase-addon",children:"Purchase Addon"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:'POST /addon/purchase\n\n{\n  "addonType": "EXTRA_SEAT",\n  "quantity": 2\n}\n'})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"MULTI_LANGUAGE_AI requires pre-selection:"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:'# 1. Select languages first\nPATCH /addon/multi-language/preferences\n{ "languages": ["spanish", "french"] }\n\n# 2. Purchase matching quantity\nPOST /addon/purchase\n{ "addonType": "MULTI_LANGUAGE_AI", "quantity": 2 }\n'})}),"\n",(0,d.jsx)(e.h3,{id:"get-purchased-addons",children:"Get Purchased Addons"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:"GET /addon/purchased\n"})}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Response:"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-json",children:'{\n  "addons": [\n    {\n      "type": "EXTRA_SEAT",\n      "name": "Extra Seat",\n      "quantity": 5,\n      "active": 3,\n      "scheduledForCancellation": 2,\n      "priceEur": 700\n    },\n    {\n      "type": "MULTI_LANGUAGE_AI",\n      "quantity": 3,\n      "active": 2,\n      "scheduledForCancellation": 1,\n      "instances": [\n        {\n          "id": 4,\n          "language": "spanish",\n          "scheduledForCancellation": false,\n          "expiresAt": "2026-03-14T11:32:23.700Z"\n        },\n        {\n          "id": 6,\n          "language": "french",\n          "scheduledForCancellation": true,\n          "expiresAt": "2026-03-14T11:35:10.858Z"\n        }\n      ]\n    }\n  ]\n}\n'})}),"\n",(0,d.jsx)(e.h3,{id:"cancel-addon",children:"Cancel Addon"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:'# For MULTI_LANGUAGE_AI (specific instance)\nDELETE /addon/cancel/MULTI_LANGUAGE_AI\n{ "userAddonId": 4 }\n\n# For other addons (by quantity)\nDELETE /addon/cancel/EXTRA_SEAT\n{ "quantity": 2 }\n\n# Cancel all\nDELETE /addon/cancel/EXTRA_SEAT\n'})}),"\n",(0,d.jsx)(e.h3,{id:"immediate-cancel-admin",children:"Immediate Cancel (Admin)"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:'DELETE /addon/cancel-immediate/EXTRA_SEAT\n{ "quantity": 1 }\n'})}),"\n",(0,d.jsx)(e.p,{children:"Returns prorated refund amount."}),"\n",(0,d.jsx)(e.h3,{id:"batch-purchase",children:"Batch Purchase"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:'POST /addon/purchase-batch\n\n{\n  "purchases": [\n    { "addonType": "EXTRA_SEAT", "quantity": 2 },\n    { "addonType": "CRM_CALENDAR_SYNC", "quantity": 1 }\n  ]\n}\n'})}),"\n",(0,d.jsx)(e.h3,{id:"check-free-allowance",children:"Check Free Allowance"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:"GET /addon/free-addons/CRM_CALENDAR_SYNC\n"})}),"\n",(0,d.jsx)(e.h3,{id:"language-specific-endpoints",children:"Language-Specific Endpoints"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-http",children:"GET /addon/available-languages\nGET /addon/multi-language/preferences\nPATCH /addon/multi-language/preferences\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"response-fields",children:"Response Fields"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"All Addons:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"quantity"}),": Total count"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"active"}),": Currently active (not scheduled for cancellation)"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"scheduledForCancellation"}),": Count cancelling at end of billing cycle"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"priceEur"}),": Price in cents (1000 = \u20ac10.00)"]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"MULTI_LANGUAGE_AI Only:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"instances[]"}),": Array of individual addon records"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"instances[].id"}),": Use for cancellation"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"instances[].language"}),": Language code"]}),"\n",(0,d.jsxs)(e.li,{children:[(0,d.jsx)(e.code,{children:"instances[].scheduledForCancellation"}),": Boolean"]}),"\n"]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"validation-rules",children:"Validation Rules"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Purchase Limits:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Active count + new quantity \u2264 plan max"}),"\n",(0,d.jsx)(e.li,{children:"Scheduled cancellations don't block new purchases"}),"\n",(0,d.jsx)(e.li,{children:"Example: Plan allows 10 seats. Have 5 active, 3 scheduled. Can purchase 5 more."}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"MULTI_LANGUAGE_AI:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Must select languages before purchase"}),"\n",(0,d.jsx)(e.li,{children:(0,d.jsx)(e.code,{children:"languages.length === quantity"})}),"\n",(0,d.jsx)(e.li,{children:"Cannot modify languages after purchase (must cancel and repurchase)"}),"\n",(0,d.jsx)(e.li,{children:"Each addon = 1 language"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Feature Addons:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"If included in plan, cannot purchase"}),"\n",(0,d.jsx)(e.li,{children:"Max quantity usually 1"}),"\n"]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"error-handling",children:"Error Handling"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Common Errors:"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-json",children:'// 400 - Plan doesn\'t support addons\n{ "message": "Individual plan does not support addon purchases" }\n\n// 400 - Exceeds limit\n{ "message": "Cannot exceed 10 total seats for BUSINESS plan..." }\n\n// 400 - Language mismatch\n{ "message": "You have selected 2 language(s) but are purchasing 1 addon(s)" }\n\n// 400 - Already included\n{ "message": "CRM/Calendar Sync is already included in your PREMIUM plan" }\n\n// 400 - Modify locked languages\n{ "message": "Language preferences cannot be modified after purchase..." }\n'})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"ui-patterns",children:"UI Patterns"}),"\n",(0,d.jsx)(e.h3,{id:"display-purchased-addons",children:"Display Purchased Addons"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-tsx",children:'{\n  addon.scheduledForCancellation > 0 && (\n    <Badge variant="warning">\n      {addon.scheduledForCancellation} cancelling on{" "}\n      {formatDate(firstExpiryDate)}\n    </Badge>\n  );\n}\n<Text>\n  {addon.active} active / {addon.quantity} total\n</Text>;\n'})}),"\n",(0,d.jsx)(e.h3,{id:"multi_language_ai-instance-list",children:"MULTI_LANGUAGE_AI Instance List"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-tsx",children:"{\n  addon.instances.map((instance) => (\n    <Row key={instance.id}>\n      <Language>{instance.language}</Language>\n      {instance.scheduledForCancellation ? (\n        <Badge>Expires {formatDate(instance.expiresAt)}</Badge>\n      ) : (\n        <CancelButton onClick={() => cancel(instance.id)} />\n      )}\n    </Row>\n  ));\n}\n"})}),"\n",(0,d.jsx)(e.h3,{id:"purchase-flow",children:"Purchase Flow"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-tsx",children:'// 1. Check availability\nconst { maxAllowed, remainingPurchasable } = await getAvailable(addonType);\n\n// 2. For MULTI_LANGUAGE_AI\nif (addonType === "MULTI_LANGUAGE_AI") {\n  await updatePreferences({ languages: selectedLanguages });\n}\n\n// 3. Purchase\nawait purchase({ addonType, quantity });\n'})}),"\n",(0,d.jsx)(e.h3,{id:"quantity-limits",children:"Quantity Limits"}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-tsx",children:"const canPurchase = addon.remainingPurchasable > 0;\nconst maxQuantity = addon.remainingPurchasable;\n\n<Input max={maxQuantity} disabled={!canPurchase} />;\n"})}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"state-management",children:"State Management"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Track locally:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Selected languages (for MULTI_LANGUAGE_AI)"}),"\n",(0,d.jsx)(e.li,{children:"Purchase quantities"}),"\n",(0,d.jsx)(e.li,{children:"Cancellation confirmations"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Refetch after:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Purchase success"}),"\n",(0,d.jsx)(e.li,{children:"Cancellation success"}),"\n",(0,d.jsx)(e.li,{children:"Plan change"}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Optimistic updates:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Show loading state during purchase"}),"\n",(0,d.jsx)(e.li,{children:"Don't optimistically update - wait for API confirmation"}),"\n",(0,d.jsx)(e.li,{children:"Scheduled cancellations remain visible until expiry"}),"\n"]}),"\n",(0,d.jsx)(e.hr,{}),"\n",(0,d.jsx)(e.h2,{id:"plan-integration",children:"Plan Integration"}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"On plan upgrade/downgrade:"})}),"\n",(0,d.jsxs)(e.ul,{children:["\n",(0,d.jsx)(e.li,{children:"Addons transfer if within new limits"}),"\n",(0,d.jsx)(e.li,{children:"Excess addons get refunded"}),"\n",(0,d.jsx)(e.li,{children:"Language preferences may be truncated"}),"\n",(0,d.jsxs)(e.li,{children:["Refetch ",(0,d.jsx)(e.code,{children:"/addon/purchased"})," after plan change"]}),"\n"]}),"\n",(0,d.jsx)(e.p,{children:(0,d.jsx)(e.strong,{children:"Check plan features:"})}),"\n",(0,d.jsx)(e.pre,{children:(0,d.jsx)(e.code,{className:"language-tsx",children:"if (addon.isIncludedInPlan) {\n  return <Badge>Included in your plan</Badge>;\n}\n"})})]})}function h(n={}){const{wrapper:e}={...(0,l.R)(),...n.components};return e?(0,d.jsx)(e,{...n,children:(0,d.jsx)(o,{...n})}):o(n)}},8453:(n,e,a)=>{a.d(e,{R:()=>i,x:()=>c});var s=a(6540);const d={},l=s.createContext(d);function i(n){const e=s.useContext(l);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function c(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(d):n.components||d:i(n.components),s.createElement(l.Provider,{value:e},n.children)}}}]);