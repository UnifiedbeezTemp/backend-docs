"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[3501],{8453:(e,n,t)=>{t.d(n,{R:()=>i,x:()=>a});var s=t(6540);const c={},r=s.createContext(c);function i(e){const n=s.useContext(r);return s.useMemo(function(){return"function"==typeof e?e(n):{...n,...e}},[n,e])}function a(e){let n;return n=e.disableParentContext?"function"==typeof e.components?e.components(c):e.components||c:i(e.components),s.createElement(r.Provider,{value:n},e.children)}},8970:(e,n,t)=>{t.r(n),t.d(n,{assets:()=>o,contentTitle:()=>a,default:()=>h,frontMatter:()=>i,metadata:()=>s,toc:()=>d});const s=JSON.parse('{"id":"channels-integration/messenger-and-instagram-integration-guide-web","title":"Facebook Messenger & Instagram Integration Guide for Web","description":"Facebook Messenger Integration","source":"@site/docs/channels-integration/messenger-and-instagram-integration-guide-web.md","sourceDirName":"channels-integration","slug":"/channels-integration/messenger-and-instagram-integration-guide-web","permalink":"/backend-docs/docs/channels-integration/messenger-and-instagram-integration-guide-web","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/channels-integration/messenger-and-instagram-integration-guide-web.md","tags":[],"version":"current","sidebarPosition":6,"frontMatter":{"sidebar_position":6},"sidebar":"tutorialSidebar","previous":{"title":"REMAINING CHANNELS INTEGRATION","permalink":"/backend-docs/docs/channels-integration/remaining-channels-integration-guide"}}');var c=t(4848),r=t(8453);const i={sidebar_position:6},a="Facebook Messenger & Instagram Integration Guide for Web",o={},d=[{value:"Facebook Messenger Integration",id:"facebook-messenger-integration",level:2},{value:"Flow",id:"flow",level:3},{value:"Disconnect",id:"disconnect",level:3},{value:"Endpoints",id:"endpoints",level:3},{value:"Instagram Integration",id:"instagram-integration",level:2},{value:"Flow",id:"flow-1",level:3},{value:"Disconnect",id:"disconnect-1",level:3},{value:"Endpoints",id:"endpoints-1",level:3},{value:"Key Points",id:"key-points",level:2}];function l(e){const n={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,r.R)(),...e.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(n.header,{children:(0,c.jsx)(n.h1,{id:"facebook-messenger--instagram-integration-guide-for-web",children:"Facebook Messenger & Instagram Integration Guide for Web"})}),"\n",(0,c.jsx)(n.h2,{id:"facebook-messenger-integration",children:"Facebook Messenger Integration"}),"\n",(0,c.jsx)(n.h3,{id:"flow",children:"Flow"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"1. Initiate"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:"const handleMessengerAuth = () => {\n  const currentPath = window.location.pathname + window.location.search;\n  const encodedPath = encodeURIComponent(currentPath);\n  window.location.href = `${API_BASE}/connect?type=messenger&redirect_path=${encodedPath}`;\n};\n"})}),"\n",(0,c.jsxs)(n.blockquote,{children:["\n",(0,c.jsx)(n.p,{children:"This endpoint is session-protected. Backend builds the OAuth URL and redirects to Facebook."}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"2. Handle Redirect"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n\n  if (\n    params.get("facebook_connected") === "true" &&\n    params.get("type") === "messenger"\n  ) {\n    setStatus("\u2705 Facebook Messenger connected");\n    loadConnectedChannels();\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n\n  if (params.get("error")) {\n    setError(decodeURIComponent(params.get("error") as string));\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,c.jsx)(n.p,{children:"Backend redirects back with:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Success"}),"\n",(0,c.jsx)(n.code,{children:"?facebook_connected=true&type=messenger"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Error"}),"\n",(0,c.jsx)(n.code,{children:"?error=..."})]}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"disconnect",children:"Disconnect"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'// Disconnect specific account\nawait fetch(`${API_BASE}/auth/facebook/account/${accountId}`, {\n  method: "DELETE",\n  credentials: "include",\n});\n\n// Or disconnect entire channel\nawait fetch(`${API_BASE}/auth/facebook/channel/${channelId}`, {\n  method: "DELETE",\n  credentials: "include",\n});\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"endpoints",children:"Endpoints"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Endpoint"}),(0,c.jsx)(n.th,{children:"Method"}),(0,c.jsx)(n.th,{children:"Auth"}),(0,c.jsx)(n.th,{children:"Purpose"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/connect?type=messenger"})}),(0,c.jsx)(n.td,{children:"GET"}),(0,c.jsx)(n.td,{children:"Session"}),(0,c.jsx)(n.td,{children:"Initiate OAuth"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/callback"})}),(0,c.jsx)(n.td,{children:"GET"}),(0,c.jsx)(n.td,{children:"No"}),(0,c.jsx)(n.td,{children:"OAuth callback"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/account/:accountId"})}),(0,c.jsx)(n.td,{children:"DELETE"}),(0,c.jsx)(n.td,{children:"Session"}),(0,c.jsx)(n.td,{children:"Remove page/account"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/channel/:channelId"})}),(0,c.jsx)(n.td,{children:"DELETE"}),(0,c.jsx)(n.td,{children:"Session"}),(0,c.jsx)(n.td,{children:"Remove all pages"})]})]})]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"instagram-integration",children:"Instagram Integration"}),"\n",(0,c.jsx)(n.h3,{id:"flow-1",children:"Flow"}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"1. Initiate"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:"const handleInstagramAuth = () => {\n  const currentPath = window.location.pathname + window.location.search;\n  const encodedPath = encodeURIComponent(currentPath);\n  window.location.href = `${API_BASE}/connect?type=instagram&redirect_path=${encodedPath}`;\n};\n"})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.p,{children:(0,c.jsx)(n.strong,{children:"2. Handle Redirect"})}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n\n  if (\n    params.get("facebook_connected") === "true" &&\n    params.get("type") === "instagram"\n  ) {\n    setStatus("\u2705 Instagram connected");\n    loadConnectedChannels();\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n\n  if (params.get("error")) {\n    setError(decodeURIComponent(params.get("error") as string));\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,c.jsx)(n.p,{children:"Backend redirects back with:"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Success"}),"\n",(0,c.jsx)(n.code,{children:"?facebook_connected=true&type=instagram"})]}),"\n",(0,c.jsxs)(n.li,{children:[(0,c.jsx)(n.strong,{children:"Error"}),"\n",(0,c.jsx)(n.code,{children:"?error=..."})]}),"\n"]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"disconnect-1",children:"Disconnect"}),"\n",(0,c.jsx)(n.pre,{children:(0,c.jsx)(n.code,{className:"language-typescript",children:'// Disconnect specific account\nawait fetch(`${API_BASE}/auth/facebook/account/${accountId}`, {\n  method: "DELETE",\n  credentials: "include",\n});\n'})}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h3,{id:"endpoints-1",children:"Endpoints"}),"\n",(0,c.jsxs)(n.table,{children:[(0,c.jsx)(n.thead,{children:(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.th,{children:"Endpoint"}),(0,c.jsx)(n.th,{children:"Method"}),(0,c.jsx)(n.th,{children:"Auth"}),(0,c.jsx)(n.th,{children:"Purpose"})]})}),(0,c.jsxs)(n.tbody,{children:[(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/connect?type=instagram"})}),(0,c.jsx)(n.td,{children:"GET"}),(0,c.jsx)(n.td,{children:"Session"}),(0,c.jsx)(n.td,{children:"Initiate OAuth"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/callback"})}),(0,c.jsx)(n.td,{children:"GET"}),(0,c.jsx)(n.td,{children:"No"}),(0,c.jsx)(n.td,{children:"OAuth callback"})]}),(0,c.jsxs)(n.tr,{children:[(0,c.jsx)(n.td,{children:(0,c.jsx)(n.code,{children:"/auth/facebook/account/:accountId"})}),(0,c.jsx)(n.td,{children:"DELETE"}),(0,c.jsx)(n.td,{children:"Session"}),(0,c.jsx)(n.td,{children:"Remove Instagram account"})]})]})]}),"\n",(0,c.jsx)(n.hr,{}),"\n",(0,c.jsx)(n.h2,{id:"key-points",children:"Key Points"}),"\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Backend fully manages OAuth (scopes, tokens, page selection, Instagram linking)"}),"\n",(0,c.jsxs)(n.li,{children:["Both Messenger and Instagram use the same Facebook OAuth flow, differentiated by ",(0,c.jsx)(n.code,{children:"type"})," parameter"]}),"\n",(0,c.jsx)(n.li,{children:"Instagram requires a Facebook Page with a linked Instagram Business Account"}),"\n",(0,c.jsxs)(n.li,{children:["Single ",(0,c.jsx)(n.code,{children:"ConnectedChannel"})," can have multiple ",(0,c.jsx)(n.code,{children:"FacebookAccount"})," records (one per page)"]}),"\n",(0,c.jsxs)(n.li,{children:["Frontend only:","\n",(0,c.jsxs)(n.ul,{children:["\n",(0,c.jsx)(n.li,{children:"Initiates auth with type parameter"}),"\n",(0,c.jsx)(n.li,{children:"Reads redirect query params"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(n.li,{children:["Session-based authentication required (",(0,c.jsx)(n.code,{children:'credentials: "include"'}),")"]}),"\n",(0,c.jsx)(n.li,{children:"Consistent success & error handling across both types"}),"\n"]}),"\n",(0,c.jsx)(n.hr,{})]})}function h(e={}){const{wrapper:n}={...(0,r.R)(),...e.components};return n?(0,c.jsx)(n,{...e,children:(0,c.jsx)(l,{...e})}):l(e)}}}]);