"use strict";(globalThis.webpackChunkbackend_docs=globalThis.webpackChunkbackend_docs||[]).push([[7553],{8453:(n,e,r)=>{r.d(e,{R:()=>d,x:()=>t});var s=r(6540);const c={},i=s.createContext(c);function d(n){const e=s.useContext(i);return s.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function t(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(c):n.components||c:d(n.components),s.createElement(i.Provider,{value:e},n.children)}},8608:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>o,contentTitle:()=>t,default:()=>h,frontMatter:()=>d,metadata:()=>s,toc:()=>a});const s=JSON.parse('{"id":"channels-integration/calendar-channels-integration-guide-web","title":"Calendar Channels Integration Guide for Web","description":"Google Calendar Integration","source":"@site/docs/channels-integration/calendar-channels-integration-guide-web.md","sourceDirName":"channels-integration","slug":"/channels-integration/calendar-channels-integration-guide-web","permalink":"/backend-docs/docs/channels-integration/calendar-channels-integration-guide-web","draft":false,"unlisted":false,"editUrl":"https://github.com/facebook/docusaurus/tree/main/packages/create-docusaurus/templates/shared/docs/channels-integration/calendar-channels-integration-guide-web.md","tags":[],"version":"current","sidebarPosition":4,"frontMatter":{"sidebar_position":4},"sidebar":"tutorialSidebar","previous":{"title":"Email channels integration guide for web","permalink":"/backend-docs/docs/channels-integration/email-channels-integration-web"},"next":{"title":"REMAINING CHANNELS INTEGRATION","permalink":"/backend-docs/docs/channels-integration/remaining-channels-integration-guide"}}');var c=r(4848),i=r(8453);const d={sidebar_position:4},t="Calendar Channels Integration Guide for Web",o={},a=[{value:"Google Calendar Integration",id:"google-calendar-integration",level:2},{value:"Flow",id:"flow",level:3},{value:"Disconnect",id:"disconnect",level:3},{value:"Endpoints",id:"endpoints",level:3},{value:"Microsoft Calendar (Outlook) Integration",id:"microsoft-calendar-outlook-integration",level:2},{value:"Flow",id:"flow-1",level:3},{value:"Disconnect",id:"disconnect-1",level:3},{value:"Endpoints",id:"endpoints-1",level:3},{value:"Shared Disconnect Endpoint",id:"shared-disconnect-endpoint",level:2},{value:"Supported Providers",id:"supported-providers",level:3},{value:"Request Body",id:"request-body",level:3},{value:"Key Points",id:"key-points",level:2}];function l(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,c.jsxs)(c.Fragment,{children:[(0,c.jsx)(e.header,{children:(0,c.jsx)(e.h1,{id:"calendar-channels-integration-guide-for-web",children:"Calendar Channels Integration Guide for Web"})}),"\n",(0,c.jsx)(e.h2,{id:"google-calendar-integration",children:"Google Calendar Integration"}),"\n",(0,c.jsx)(e.h3,{id:"flow",children:"Flow"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"1. Initiate"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:"const handleGoogleCalendarAuth = () => {\n  const currentPath = window.location.pathname + window.location.search;\n  const encodedPath = encodeURIComponent(currentPath);\n  window.location.href = `${API_BASE}/google/auth?redirect_path=${encodedPath}`;\n};\n"})}),"\n",(0,c.jsxs)(e.blockquote,{children:["\n",(0,c.jsx)(e.p,{children:"This endpoint is session-protected. Backend builds the OAuth URL and redirects to Google."}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"2. Handle Redirect"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n\n  if (\n    params.get("calendar_connected") === "true" &&\n    params.get("provider") === "google"\n  ) {\n    setStatus("\u2705 Google Calendar connected");\n    loadConnectedCalendars();\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n\n  if (params.get("error")) {\n    setError(decodeURIComponent(params.get("error") as string));\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,c.jsx)(e.p,{children:"Backend redirects back with:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Success"}),"\n",(0,c.jsx)(e.code,{children:"?calendar_connected=true&provider=google"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Error"}),"\n",(0,c.jsx)(e.code,{children:"?error=..."})]}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"disconnect",children:"Disconnect"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:'await fetch(`${API_BASE}/channels/calendar/disconnect/google_calendar`, {\n  method: "POST",\n  credentials: "include",\n  headers: { "Content-Type": "application/json" },\n  body: JSON.stringify({ accountId }),\n});\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"endpoints",children:"Endpoints"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"Endpoint"}),(0,c.jsx)(e.th,{children:"Method"}),(0,c.jsx)(e.th,{children:"Auth"}),(0,c.jsx)(e.th,{children:"Purpose"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/google/auth"})}),(0,c.jsx)(e.td,{children:"GET"}),(0,c.jsx)(e.td,{children:"Session"}),(0,c.jsx)(e.td,{children:"Initiate OAuth"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/google/callback"})}),(0,c.jsx)(e.td,{children:"GET"}),(0,c.jsx)(e.td,{children:"No"}),(0,c.jsx)(e.td,{children:"OAuth callback"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/disconnect/google_calendar"})}),(0,c.jsx)(e.td,{children:"POST"}),(0,c.jsx)(e.td,{children:"Session"}),(0,c.jsx)(e.td,{children:"Remove connection"})]})]})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"microsoft-calendar-outlook-integration",children:"Microsoft Calendar (Outlook) Integration"}),"\n",(0,c.jsx)(e.h3,{id:"flow-1",children:"Flow"}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"1. Initiate"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:"const handleMicrosoftCalendarAuth = () => {\n  const currentPath = window.location.pathname + window.location.search;\n  const encodedPath = encodeURIComponent(currentPath);\n  window.location.href = `${API_BASE}/microsoft/auth?redirect_path=${encodedPath}`;\n};\n"})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.p,{children:(0,c.jsx)(e.strong,{children:"2. Handle Redirect"})}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:'useEffect(() => {\n  const params = new URLSearchParams(window.location.search);\n\n  if (\n    params.get("calendar_connected") === "true" &&\n    params.get("provider") === "microsoft"\n  ) {\n    setStatus("\u2705 Microsoft Calendar connected");\n    loadConnectedCalendars();\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n\n  if (params.get("error")) {\n    setError(decodeURIComponent(params.get("error") as string));\n    window.history.replaceState({}, "", window.location.pathname);\n  }\n}, []);\n'})}),"\n",(0,c.jsx)(e.p,{children:"Backend redirects back with:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Success"}),"\n",(0,c.jsx)(e.code,{children:"?calendar_connected=true&provider=microsoft"})]}),"\n",(0,c.jsxs)(e.li,{children:[(0,c.jsx)(e.strong,{children:"Error"}),"\n",(0,c.jsx)(e.code,{children:"?error=..."})]}),"\n"]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"disconnect-1",children:"Disconnect"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:'await fetch(`${API_BASE}/channels/calendar/disconnect/microsoft_calendar`, {\n  method: "POST",\n  credentials: "include",\n  headers: { "Content-Type": "application/json" },\n  body: JSON.stringify({ accountId }),\n});\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h3,{id:"endpoints-1",children:"Endpoints"}),"\n",(0,c.jsxs)(e.table,{children:[(0,c.jsx)(e.thead,{children:(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.th,{children:"Endpoint"}),(0,c.jsx)(e.th,{children:"Method"}),(0,c.jsx)(e.th,{children:"Auth"}),(0,c.jsx)(e.th,{children:"Purpose"})]})}),(0,c.jsxs)(e.tbody,{children:[(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/microsoft/auth"})}),(0,c.jsx)(e.td,{children:"GET"}),(0,c.jsx)(e.td,{children:"Session"}),(0,c.jsx)(e.td,{children:"Initiate OAuth"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/microsoft/callback"})}),(0,c.jsx)(e.td,{children:"GET"}),(0,c.jsx)(e.td,{children:"No"}),(0,c.jsx)(e.td,{children:"OAuth callback"})]}),(0,c.jsxs)(e.tr,{children:[(0,c.jsx)(e.td,{children:(0,c.jsx)(e.code,{children:"/channels/calendar/disconnect/microsoft_calendar"})}),(0,c.jsx)(e.td,{children:"POST"}),(0,c.jsx)(e.td,{children:"Session"}),(0,c.jsx)(e.td,{children:"Remove connection"})]})]})]}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"shared-disconnect-endpoint",children:"Shared Disconnect Endpoint"}),"\n",(0,c.jsxs)(e.p,{children:["Both Email and Calendar channels use a ",(0,c.jsx)(e.strong,{children:"single unified disconnect handler"}),"."]}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-typescript",children:"POST /channels/calendar/disconnect/:provider\n"})}),"\n",(0,c.jsx)(e.h3,{id:"supported-providers",children:"Supported Providers"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:"google_calendar"})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:"microsoft_calendar"})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:"gmail"})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:"outlook"})}),"\n",(0,c.jsx)(e.li,{children:(0,c.jsx)(e.code,{children:"custom"})}),"\n"]}),"\n",(0,c.jsx)(e.h3,{id:"request-body",children:"Request Body"}),"\n",(0,c.jsx)(e.pre,{children:(0,c.jsx)(e.code,{className:"language-json",children:'{\n  "accountId": 123\n}\n'})}),"\n",(0,c.jsx)(e.hr,{}),"\n",(0,c.jsx)(e.h2,{id:"key-points",children:"Key Points"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Backend fully manages OAuth (scopes, tokens, refresh, revocation)"}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Frontend only:"}),"\n",(0,c.jsxs)(e.ul,{children:["\n",(0,c.jsx)(e.li,{children:"Initiates auth"}),"\n",(0,c.jsx)(e.li,{children:"Reads redirect query params"}),"\n"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsxs)(e.p,{children:["Session-based authentication required\n(",(0,c.jsx)(e.code,{children:'credentials: "include"'}),")"]}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Consistent success & error handling across Email and Calendar"}),"\n"]}),"\n",(0,c.jsxs)(e.li,{children:["\n",(0,c.jsx)(e.p,{children:"Same UI logic can be reused for both channels"}),"\n"]}),"\n"]}),"\n",(0,c.jsx)(e.hr,{})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,c.jsx)(e,{...n,children:(0,c.jsx)(l,{...n})}):l(n)}}}]);